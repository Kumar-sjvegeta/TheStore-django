<!DOCTYPE html>
<html>
<head>
    <title>Products</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: center;
        }

        input[type=number] {
            width: 60px;
        }

        button {
            margin: 0 5px;
        }

        .quantity-controls {
            display: none;
        }
    </style>
    <script>
        function showQuantityControls(id) {
            document.getElementById('select_btn_' + id).style.display = 'none';
            document.getElementById('quantity_controls_' + id).style.display = 'inline-block';
        }

        function increment(id) {
            var input = document.getElementById('quantity_' + id);
            input.value = parseInt(input.value) + 1;
        }

        function decrement(id) {
            var input = document.getElementById('quantity_' + id);
            if (parseInt(input.value) > 1) {
                input.value = parseInt(input.value) - 1;
            }
        }
    </script>
</head>
<body>
    <h1>Products</h1>
    <form method="POST" action="{% url 'customer_checkout' %}">
        {% csrf_token %}
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Status</th>
                    <th>Select Quantity</th>
                </tr>
            </thead>
            <tbody>
                {% for product in products %}
                <tr>
                    <td>{{ product.name }}</td>
                    <td>${{ product.price }}</td>
                    <td>
                        {% if product.quantity > 0 %}
                            In Stock
                        {% else %}
                            Out of Stock
                        {% endif %}
                    </td>
                    <td>
                        {% if product.quantity > 0 %}
                            <!-- Select Button -->
                            <button type="button" id="select_btn_{{ product.id }}" onclick="showQuantityControls('{{ product.id }}')">Select</button>

                            <!-- Quantity Controls (initially hidden) -->
                            <span class="quantity-controls" id="quantity_controls_{{ product.id }}">
                                <button type="button" onclick="decrement('{{ product.id }}')">-</button>
                                <input type="number" name="quantity_{{ product.id }}" id="quantity_{{ product.id }}" value="1" min="1" max="{{ product.quantity }}">
                                <button type="button" onclick="increment('{{ product.id }}')">+</button>
                            </span>
                        {% else %}
                            N/A
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <br>
        <button type="submit">Checkout</button>
    </form>
</body>
</html>
